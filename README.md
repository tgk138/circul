# Telegram бот для создания кружочков из видео

Бот принимает ссылку на видео или видео файл, скачивает его (если это ссылка), нарезает на отрезки 5-15 секунд и отправляет обратно в виде круглых видеозаметок (кружочков).

## Возможности

- ✅ **Обработка всевозможных загрузок:** Бот принимает видео файлы напрямую, документы с видео, а также ссылки на видео с различных платформ
- ✅ **Умная обрезка без полей:** Видео автоматически обрезается до квадратного формата без черных полей для идеального кружочка
- ✅ **Поддержка множества платформ:** Работает с 1000+ видеохостингов через yt-dlp

## Требования

- Python 3.10 или выше
- FFmpeg (должен быть установлен в системе и доступен через PATH)

### Установка FFmpeg

**Windows:**
1. Скачайте FFmpeg с [официального сайта](https://ffmpeg.org/download.html)
2. Распакуйте архив
3. Добавьте папку `bin` в переменную окружения PATH
4. Проверьте установку: `ffmpeg -version`

**Linux:**
```bash
sudo apt update
sudo apt install ffmpeg
```

**macOS:**
```bash
brew install ffmpeg
```

## Установка

1. Клонируйте репозиторий или скачайте файлы проекта

2. Создайте виртуальное окружение:
```bash
python -m venv venv
```

3. Активируйте виртуальное окружение:

   **Windows:**
   ```bash
   venv\Scripts\activate
   ```

   **Linux/macOS:**
   ```bash
   source venv/bin/activate
   ```

4. Установите зависимости:
```bash
pip install -r requirements.txt
```

5. Создайте файл `.env` в корне проекта:
```env
BOT_TOKEN=your_bot_token_here
```

   Чтобы получить токен:
   - Откройте Telegram и найдите [@BotFather](https://t.me/BotFather)
   - Отправьте команду `/newbot`
   - Следуйте инструкциям для создания бота
   - Скопируйте полученный токен в файл `.env`

## Использование

### Быстрый запуск (Windows)

**Вариант 1: Двойной клик по файлу**
- Просто запустите `start.bat` двойным кликом в проводнике Windows
- Скрипт автоматически активирует venv и запустит бота

**Вариант 2: Через командную строку (CMD)**
```bash
start.bat
```

**Вариант 3: PowerShell**
```powershell
.\start.bat
```
или
```powershell
.\start.ps1
```

**Важно:** В PowerShell всегда используйте `.\` перед именем скрипта!

### Ручной запуск

1. Активируйте виртуальное окружение:
```bash
# Windows
venv\Scripts\activate

# Linux/macOS
source venv/bin/activate
```

2. Запустите бота:
```bash
python bot.py
```

### Первоначальная настройка

Если это первый запуск, используйте скрипт настройки:
```bash
setup.bat
```

Он автоматически:
- Создаст виртуальное окружение (если нужно)
- Установит все зависимости
- Создаст шаблон файла .env

3. Откройте Telegram и найдите вашего бота

4. Отправьте боту:
   - **Ссылку на видео** с любой поддерживаемой платформы (см. список ниже)
   - **Видео файл** напрямую в чат
   - **Документ с видео** (MP4, WebM, MOV и другие форматы)

5. Бот обработает видео, обрежет до квадрата без полей, нарежет на отрезки по 10 секунд и отправит их обратно в виде кружочек

## Поддерживаемые сервисы для скачивания видео

Бот использует [yt-dlp](https://github.com/yt-dlp/yt-dlp), который поддерживает **более 1000 платформ**. Вот основные популярные сервисы:

### Видеохостинги
- **YouTube** - полная поддержка видео, плейлистов, стримов
- **Rutube** - российский видеохостинг
- **Vimeo** - профессиональные видео
- **Dailymotion** - международный видеохостинг
- **Bilibili** - китайский видеохостинг

### Социальные сети
- **TikTok** - короткие видео
- **Instagram** - видео из постов, Reels, IGTV
- **Facebook** - видео из постов и страниц
- **Twitter/X** - видео из твитов
- **Reddit** - видео из постов
- **LinkedIn** - корпоративные видео

### Стриминговые платформы
- **Twitch** - записи стримов и клипы
- **VK (ВКонтакте)** - видео из постов и альбомов
- **Odnoklassniki** - видео из постов

### Другие платформы
- **SoundCloud** - аудио с обложками
- **Spotify** - подкасты и видео
- **Pinterest** - видео из пинов
- И многие другие...

*Полный список поддерживаемых платформ доступен в [документации yt-dlp](https://github.com/yt-dlp/yt-dlp/blob/master/supportedsites.md)*

## Ограничения

- Максимальная длительность одного кружочка: 60 секунд
- Максимальный размер файла: 10 МБ
- Разрешение видео: 640x640 пикселей (квадратное)
- Видео автоматически обрезается до квадрата без черных полей

## Структура проекта

```
Кружочки/
├── bot.py                 # Основной файл бота
├── video_processor.py     # Обработка видео
├── config.py             # Конфигурация
├── requirements.txt      # Зависимости
├── .env                  # Токен бота (не коммитить!)
├── .gitignore
├── README.md
└── temp_videos/          # Временные файлы (создаётся автоматически)
```

## Примечания

- Временные файлы автоматически удаляются после обработки
- Если видео слишком большое, бот автоматически оптимизирует размер файла
- Все операции выполняются асинхронно для лучшей производительности
- Бот поддерживает обработку видео файлов в форматах: MP4, WebM, MOV, AVI, MKV, FLV, WMV, M4V
- Видео обрезается до квадрата без черных полей для идеального кружочка

